一、系统总体目标
构建一个智能 ICD 自动编码前后端交互系统，整合:
•	小模型(CAML、DCAN、Fusion、TransICD 等)
•	大模型(如 MedGemma、BioMedLM、GPT 系列)
•	知识图谱(ICD 层级 + 医学知识图谱)
实现从病例输入 → 自动编码 → 语义验证 → 知识解释 → 可视化展示的全流程闭环。
二、系统架构概述
前端:
•	病例输入与上传                             
  •   模型与参数选择                             
•   预测结果展示(ICD代码 + 概率)             
•   知识路径可视化(图谱高亮)                 
•   解释性结果展示(关键词热度)               
后端:
• 数据预处理模块
(1)文本清洗、分词、标准化
(2)医学实体识别(NER)  
 •  模型管理与协同推理
(1) 小模型集群管理(CAML/DCAN/Fusion等)
(2) 大模型协作(LLM验证与解释推理)
•  知识图谱模块
(1) ICD层次树+UMLS知识库
(2) 概念匹配、语义约束、路径查询
•  推理与解释模块
(1)预测ICD编码+概率
(2)Integrated Gradients/Attention 解释
(3)结合图谱生成知识路径解释
•  系统接口层(FastAPI)
/predict    → 实时推理接口              
    /models     → 模型列表与切换             
/graph      → 知识图谱可视化数据         
 /explain    → 可解释性结果输出  
数据层:
模型权重仓库(小模型+LLM)
知识图谱数据库(Neo4j/NebulaGraph)
结构化病例样本存储(MySQL/MongoDB)
三、模块划分以及功能说明
模块 1:病例输入与数据预处理
前端功能:
(1)输入框(粘贴病例)
(2)选择语言与预处理选项(如去停用词/保留数字)
后端处理:
•	调用预处理模块:
(1)文本清洗、分词、术语标准化
(2)医学实体识别(disease、symptom、procedure)
(3)生成统一输入格式(供小模型 & LLM使用)
模块 2:模型协同推理引擎
功能目标:通过小模型预测 + 大模型验证 + 知识图谱修正的三阶段协同机制生成最终 ICD 编码。
主要功能:
•  (1)小模型预测 → 输出 top-k ICD + 概率分布
•  (2)知识图谱检索 → 过滤不合理编码
•  (3)大模型验证 → 对每个候选 ICD 进行语义判断与理由生成
•  (4)输出融合结果(加权平均或 LLM裁决)
返回内容示例:
 
模块 3:大模型辅助与解释
功能目标:• 
 (1)对预测结果进行自然语言解释
•     (2)提供编码理由与知识支撑
•     (3)若小模型信度低，大模型可直接参与生成候选 ICD
交互接口:
•  /llm/verify:验证小模型输出的语义合理性
•  /llm/explain:生成可读的医学解释文本

模块 4:知识图谱子系统
功能目标:
•  (1)医学概念层级关系查询(ICD层次结构)
•  (2)语义相似度检索(heart attack ≈ myocardial infarction)
•  (3)可视化路径输出(供前端展示)
数据结构示例:
 
接口:
• /graph/query?icd=410.71 → 返回相关节点与边
• /graph/explain?icd=410.71 → 返回知识路径

模块 5:结果展示与可视化 
前端界面包括:
1.	预测结果区
o	表格展示 ICD 编码、名称、置信度
2.	文本高亮区
o	显示病例中关键医学词(高亮颜色 = 权重强度)
3.	知识图谱可视化
o	使用 D3.js / ECharts 渲染图谱路径(ICD ↔ 症状 ↔ 疾病)
4.	模型切换与参数面板
o	允许用户选择不同小模型、大模型权重
5.	性能展示区
o	展示每个模型的 Micro-F1、Top-k Precision 曲线


